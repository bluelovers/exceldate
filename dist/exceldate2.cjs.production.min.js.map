{"version":3,"file":"exceldate2.cjs.production.min.js","sources":["../src/index.ts"],"sourcesContent":["\nexport function exceldateTs<T = number>(excelDate: string | number,\n\tdone = (err: Error, unixTs?: number): T =>\n\t{\n\t\tif (err) throw err\n\t\treturn unixTs as any\n\t},\n)\n{\n\tif (!excelDate)\n\t{\n\t\treturn done(new Error('No first argument provided, nothing to convert.'))\n\t}\n\ttry\n\t{\n\t\t// Convert input to a number\n\t\t// @ts-ignore\n\t\tconst excelDateNumber = Number.parseFloat(excelDate, 10)\n\t\tif (Number.isNaN(excelDateNumber))\n\t\t{\n\t\t\treturn done(new Error('First argument could not be parsed.'))\n\t\t}\n\n\t\t// Convert input to JS Date\n\t\t// Details here (mostly in comments): https://gist.github.com/christopherscott/2782634\n\t\tconst secondsInDay = 24 * 60 * 60\n\t\tconst excelEpoch = new Date(Date.UTC(1899, 11, 31))\n\t\tconst excelEpochTs = excelEpoch.getTime()\n\t\tconst missingLeapYearDay = secondsInDay * 1000\n\n\t\tconst excelDelta = excelEpochTs - missingLeapYearDay\n\t\tconst excelTs = excelDateNumber * secondsInDay * 1000\n\t\tconst unixTs = excelTs + excelDelta\n\n\t\treturn done(null, unixTs)\n\t}\n\tcatch (e)\n\t{\n\t\treturn done(e)\n\t}\n}\n\n/**\n * Takes an Excel timestamp (as a number or string) and returns a corresponding Date object\n */\nexport function exceldate<T = Date>(excelDate: string | number,\n\tdone = (err: Error, res?: Date): T =>\n\t{\n\t\tif (err) throw err\n\t\treturn res as any\n\t},\n)\n{\n\treturn exceldateTs(excelDate, (err: Error, unixTs?: number) => {\n\t\tif (err)\n\t\t{\n\t\t\treturn done(err)\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst jsDate = new Date(unixTs)\n\t\t\t\treturn done(null, jsDate)\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\treturn done(e)\n\t\t\t}\n\t\t}\n\t})\n}\n\nexport default exceldate\n"],"names":["exceldateTs","excelDate","done","err","unixTs","Error","excelDateNumber","Number","parseFloat","isNaN","Date","UTC","getTime","secondsInDay","e","exceldate","res","jsDate"],"mappings":"sBACgBA,EAAwBC,EACvCC,eAAAA,IAAAA,EAAO,SAACC,EAAYC,MAEfD,EAAK,MAAMA,SACRC,KAIHH,SAEGC,EAAK,IAAIG,MAAM,4DAMhBC,EAAkBC,OAAOC,WAAWP,EAAW,WACjDM,OAAOE,MAAMH,GAETJ,EAAK,IAAIG,MAAM,wCAchBH,EAAK,KATS,MAMLI,EAAiC,KAL9B,IAAII,KAAKA,KAAKC,IAAI,KAAM,GAAI,KACfC,UACLC,QAQ5B,MAAOC,UAECZ,EAAKY,aAOEC,EAAoBd,EACnCC,mBAAAA,IAAAA,EAAO,SAACC,EAAYa,MAEfb,EAAK,MAAMA,SACRa,IAIDhB,EAAYC,GAAW,SAACE,EAAYC,MACtCD,SAEID,EAAKC,WAMLc,EAAS,IAAIP,KAAKN,UACjBF,EAAK,KAAMe,GAEnB,MAAOH,UAECZ,EAAKY"}